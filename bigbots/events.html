<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Step 4: Creating Standalone Event Handler | Discordeno</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="Docs for Discordeno">
    <meta name="theme-color" content="#7289DA">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="og:title" content="Discordeno">
    <meta name="og:description" content="Docs for Discordeno">
    <meta name="og:type" content="website">
    <meta name="og:url" content="https://discordeno.mod.land">
    <meta name="og:image" content="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.1ace810b.css" as="style"><link rel="preload" href="/assets/js/app.47c0f61d.js" as="script"><link rel="preload" href="/assets/js/2.23f761a3.js" as="script"><link rel="preload" href="/assets/js/18.1271597a.js" as="script"><link rel="prefetch" href="/assets/js/10.f7119d90.js"><link rel="prefetch" href="/assets/js/11.6e177a84.js"><link rel="prefetch" href="/assets/js/12.ec7ca605.js"><link rel="prefetch" href="/assets/js/13.27c972db.js"><link rel="prefetch" href="/assets/js/14.263b4bd0.js"><link rel="prefetch" href="/assets/js/15.6a3f510d.js"><link rel="prefetch" href="/assets/js/16.5b0fd976.js"><link rel="prefetch" href="/assets/js/17.50c2f382.js"><link rel="prefetch" href="/assets/js/19.e905f206.js"><link rel="prefetch" href="/assets/js/20.53f7f906.js"><link rel="prefetch" href="/assets/js/21.863f3755.js"><link rel="prefetch" href="/assets/js/22.b4258ffc.js"><link rel="prefetch" href="/assets/js/23.10283aec.js"><link rel="prefetch" href="/assets/js/24.5998a7ab.js"><link rel="prefetch" href="/assets/js/25.3ab27122.js"><link rel="prefetch" href="/assets/js/26.01ce2cc4.js"><link rel="prefetch" href="/assets/js/27.14cd232d.js"><link rel="prefetch" href="/assets/js/28.1f915983.js"><link rel="prefetch" href="/assets/js/29.4118fcc0.js"><link rel="prefetch" href="/assets/js/3.824c1225.js"><link rel="prefetch" href="/assets/js/30.32fd2e73.js"><link rel="prefetch" href="/assets/js/31.603951b2.js"><link rel="prefetch" href="/assets/js/32.d56bb281.js"><link rel="prefetch" href="/assets/js/4.5dfc082b.js"><link rel="prefetch" href="/assets/js/5.1abd96ea.js"><link rel="prefetch" href="/assets/js/6.bf5661e1.js"><link rel="prefetch" href="/assets/js/7.2652b49a.js"><link rel="prefetch" href="/assets/js/8.fa0c58e6.js"><link rel="prefetch" href="/assets/js/9.e48a8921.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1ace810b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Discordeno</span></a> <div class="links"><!----> <div class="user-settings"><a href="#" class="settings-button"><svg aria-hidden="true" data-prefix="fas" data-icon="cog" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-cog fa-w-16 settings-icon"><path fill="currentColor" d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"></path></svg></a> <div class="user-settings-menu" style="display:none;"><div class="theme-options"><!----> <!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox"></div> <!----> <!----></div></div></div> <!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://doc.deno.land/https/deno.land/x/discordeno/mod.ts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.gg/5vBgXk3UcZ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/discordeno/guide" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://doc.deno.land/https/deno.land/x/discordeno/mod.ts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.gg/5vBgXk3UcZ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/discordeno/guide" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Home</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Big Bots Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigbots/" aria-current="page" class="sidebar-link">Step By Step Guide</a></li><li><a href="/bigbots/rest.html" class="sidebar-link">Step 1: Creating A Standalone REST Process</a></li><li><a href="/bigbots/gateway.html" class="sidebar-link">Step 2: Creating A Standalone Gateway Process</a></li><li><a href="/bigbots/cache.html" class="sidebar-link">Step 3: Standalone Cache Process</a></li><li><a href="/bigbots/events.html" aria-current="page" class="active sidebar-link">Step 4: Creating Standalone Event Handler</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Step By Step Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Advanced Guide</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="step-4-creating-standalone-event-handler"><a href="#step-4-creating-standalone-event-handler" class="header-anchor">#</a> Step 4: Creating Standalone Event Handler</h1> <p>Now we are about to start working on the bot code itself. The last 3 steps should be completed by the time you reach this. The event handler process will be listening for events from any number of gateway instances and be ready to handle them.</p> <h2 id="why-use-standalone-event-handler-process"><a href="#why-use-standalone-event-handler-process" class="header-anchor">#</a> Why Use Standalone Event Handler Process?</h2> <p>The standalone event handler is the portion of your bot code that you will be changing the most. The three previous steps created processes that are intended to never be turned off. This process is designed to let you restart whenever you wish and be incredibly quick to restart. Since we don't have the delay to start up shards anymore, your code becomes reloaded instantly.</p> <h2 id="creating-event-handlers"><a href="#creating-event-handlers" class="header-anchor">#</a> Creating Event Handlers</h2> <p>Create a file path like <code>src/bot/mod.ts</code>.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">DISCORD_TOKEN</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../configs.ts'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createBot<span class="token punctuation">,</span> createUtils<span class="token punctuation">,</span> createTransformers<span class="token punctuation">,</span> createHelpers<span class="token punctuation">,</span> transformRole<span class="token punctuation">,</span> DiscordenoRole <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../deps.ts'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> psql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cache/mod.ts&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token function">createBot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  token<span class="token operator">:</span> <span class="token constant">DISCORD_TOKEN</span><span class="token punctuation">,</span>
  botId<span class="token operator">:</span> <span class="token number">270010330782892032n</span><span class="token punctuation">,</span>
  <span class="token comment">// applicationId: 270010330782892032,</span>
  events<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">messageCreate</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>bot<span class="token punctuation">,</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'message arrived'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  intents<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Guilds'</span><span class="token punctuation">,</span> <span class="token string">'GuildMessages'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  cache<span class="token operator">:</span> <span class="token punctuation">{</span>
    isAsync<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">customTableCreator</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>table<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;guilds&quot;</span><span class="token operator">:</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// what now</span>
              <span class="token keyword">return</span> <span class="token keyword">await</span> psql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">SELECT * FROM &quot;guilds&quot; WHERE &quot;id&quot; = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// CUSTOMIZE INTERNALS</span>
bot <span class="token operator">=</span> <span class="token function">customizeBotInternals</span><span class="token punctuation">(</span>bot<span class="token punctuation">)</span><span class="token punctuation">;</span>
bot<span class="token punctuation">.</span>transformers<span class="token punctuation">.</span><span class="token function-variable function">role</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> role<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> internalRole <span class="token operator">=</span> <span class="token function">transformRole</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> role<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span> <span class="token operator">=</span> internalRole<span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> rest <span class="token keyword">as</span> DiscordenoRole<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/discordeno/guide/edit/main/src/bigbots/events.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/6/2021, 2:39:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/bigbots/cache.html" class="prev">
        Step 3: Standalone Cache Process
      </a></span> <span class="next"><a href="/stepbystep/">
        Step By Step Guide
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.47c0f61d.js" defer></script><script src="/assets/js/2.23f761a3.js" defer></script><script src="/assets/js/18.1271597a.js" defer></script>
  </body>
</html>
